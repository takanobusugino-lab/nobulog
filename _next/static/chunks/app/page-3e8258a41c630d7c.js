(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9917:function(e,t,r){Promise.resolve().then(r.bind(r,3356))},3356:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var a=r(7437),s=r(2265);function l(){let[e,t]=(0,s.useState)(""),[r,l]=(0,s.useState)([]),[o,n]=(0,s.useState)(1),[i,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(!1),[h,m]=(0,s.useState)(null),[b,p]=(0,s.useState)(new Set),x=b.size,f=(0,s.useCallback)(e=>{p(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r})},[]),g=(0,s.useCallback)(async(t,r)=>{if(!e){m("URLを入力してください");return}u(!0),m(null);try{let a=await fetch("/api/scrape?page=".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e.trim()})}),s=await a.json();if(!a.ok||s.error)throw Error(s.error||"取得に失敗しました");c(s.hasMore),n(t),l(e=>r?[...e,...s.images]:s.images)}catch(e){var a;m(null!==(a=null==e?void 0:e.message)&&void 0!==a?a:"取得に失敗しました")}finally{u(!1)}},[e]),y=(0,s.useCallback)(async e=>{null==e||e.preventDefault(),p(new Set),await g(1,!1)},[g]),w=(0,s.useCallback)(async()=>{await g(o+1,!0)},[g,o]),j=(0,s.useCallback)(async()=>{if(0===b.size){m("ダウンロードする画像を選択してください");return}u(!0),m(null);try{let e=await fetch("/api/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:Array.from(b)})});if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||"ダウンロードに失敗しました")}let t=await e.blob(),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="images.zip",document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(r)}catch(t){var e;m(null!==(e=null==t?void 0:t.message)&&void 0!==e?e:"ダウンロードに失敗しました")}finally{u(!1)}},[b]),v=(0,s.useMemo)(()=>r.length>0,[r.length]);return(0,a.jsxs)("div",{className:"min-h-screen px-6 py-12",children:[(0,a.jsxs)("div",{className:"mx-auto flex max-w-6xl flex-col gap-8",children:[(0,a.jsxs)("header",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-base uppercase tracking-[0.4em] text-gray-400",children:"Image Scraper Downloader"}),(0,a.jsx)("h1",{className:"text-5xl font-semibold tracking-tight text-white",children:"任意サイトの画像を取得して選択・ダウンロード"}),(0,a.jsxs)("p",{className:"text-gray-300",children:["公開サイトの画像を最大",100,"件ずつ表示し、選択してZIPでダウンロードできます。"]})]}),(0,a.jsxs)("form",{onSubmit:y,className:"flex flex-col gap-3 rounded-2xl border border-white/10 bg-white/5 p-4 shadow-xl shadow-black/30 backdrop-blur",children:[(0,a.jsx)("label",{className:"text-sm text-gray-300",htmlFor:"targetUrl",children:"画像を取得したいページのURL"}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row",children:[(0,a.jsx)("input",{id:"targetUrl",type:"url",required:!0,placeholder:"https://example.com",value:e,onChange:e=>t(e.target.value),className:"w-full rounded-xl border border-white/10 bg-black/40 px-4 py-3 text-white placeholder:text-gray-500 focus:border-white/30 focus:outline-none"}),(0,a.jsx)("button",{type:"submit",disabled:d,className:"w-full rounded-xl bg-gradient-to-r from-emerald-500 to-cyan-500 text-black px-4 py-3 text-sm font-semibold transition hover:brightness-110 disabled:cursor-not-allowed disabled:opacity-60 sm:w-40",children:d?"読み込み中...":"表示"})]}),h&&(0,a.jsx)("p",{className:"text-sm text-red-300",children:h})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-300",children:[(0,a.jsxs)("span",{children:["取得件数: ",r.length," ",i?"(さらに取得可能)":""]}),(0,a.jsxs)("span",{children:["選択: ",x," 件"]})]}),(0,a.jsxs)("section",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 shadow-lg shadow-black/20 backdrop-blur",children:[v?(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5",children:r.map(e=>{let t=b.has(e);return(0,a.jsxs)("label",{className:"group relative block overflow-hidden rounded-xl border ".concat(t?"border-white/70":"border-white/10"," bg-black/40 transition hover:border-white/50"),children:[(0,a.jsx)("input",{type:"checkbox",className:"peer absolute left-2 top-2 h-4 w-4 accent-white",checked:t,onChange:()=>f(e)}),(0,a.jsx)("div",{className:"flex min-h-[140px] items-center justify-center bg-black/30",children:(0,a.jsx)("img",{src:e,alt:"",className:"max-h-48 w-full object-contain transition duration-200 peer-checked:opacity-90",loading:"lazy",referrerPolicy:"no-referrer"})}),(0,a.jsx)("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent to-black/40 opacity-0 transition group-hover:opacity-100"})]},e)})}):(0,a.jsx)("div",{className:"flex min-h-[200px] items-center justify-center text-gray-400",children:"ここに画像が表示されます"}),(0,a.jsx)("div",{className:"mt-6 flex flex-wrap gap-3",children:(0,a.jsx)("button",{type:"button",onClick:w,disabled:!i||d,className:"rounded-xl border border-white/20 bg-white/5 px-4 py-2 text-sm text-white transition hover:border-white/40 disabled:cursor-not-allowed disabled:opacity-50",children:"さらに見る"})})]})]}),i&&(0,a.jsx)("div",{className:"fixed right-4 bottom-6 z-30 sm:right-6 sm:bottom-8",children:(0,a.jsx)("button",{type:"button",onClick:w,disabled:!i||d,className:"rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 px-5 py-3 text-sm font-semibold text-white shadow-lg shadow-purple-600/30 transition hover:brightness-110 disabled:cursor-not-allowed disabled:opacity-60",children:"さらに見る"})}),(0,a.jsx)("div",{className:"fixed left-4 bottom-6 z-30 sm:left-6 sm:top-1/2 sm:-translate-y-1/2",children:(0,a.jsxs)("button",{type:"button",onClick:j,disabled:d||0===x,className:"rounded-full bg-gradient-to-r from-emerald-500 to-cyan-500 px-6 py-3 text-sm font-semibold text-black shadow-lg shadow-emerald-500/30 transition hover:brightness-110 disabled:cursor-not-allowed disabled:opacity-60",children:["ダウンロード (",x,")"]})})]})}},622:function(e,t,r){"use strict";var a=r(2265),s=Symbol.for("react.element"),l=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};function i(e,t,r){var a,i={},c=null,d=null;for(a in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)l.call(t,a)&&!n.hasOwnProperty(a)&&(i[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===i[a]&&(i[a]=t[a]);return{$$typeof:s,type:e,key:c,ref:d,props:i,_owner:o.current}}t.jsx=i,t.jsxs=i},7437:function(e,t,r){"use strict";e.exports=r(622)}},function(e){e.O(0,[971,472,744],function(){return e(e.s=9917)}),_N_E=e.O()}]);